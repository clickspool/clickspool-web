(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[87],{uX9h:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var s=l(a("2/Rp"));a("iQDF");var r=l(a("+eQT"));a("7Kak");var u=l(a("9yH6"));a("IzEo");var d=l(a("bx4M")),i=l(a("jehZ"));a("14J3");var f=l(a("BMrR"));a("jCWc");var o=l(a("kPKH")),m=l(a("p0pE"));a("miYZ");var c=l(a("tsqr")),p=l(a("2Taf")),g=l(a("vZ4D")),h=l(a("MhPg")),y=l(a("l4Ni")),_=l(a("ujKo"));a("y8nQ");var E=l(a("Vl3Y"));a("5NDa");var M=l(a("5rEg"));a("OaEy");var x,v,w,b,D=l(a("2fM7")),Y=l(a("ICWT")),C=a("VkhE"),I=a("+n12"),k=l(a("c0LQ")),T=a("MuoO"),j=n(a("q1tI")),H=(l(a("wY1l")),a("LLXN")),N=l(a("3a4m")),S=l(a("mwIZ")),A=l(a("J2iB")),R=l(a("sunZ")),V=a("OpHJ");function G(e){return function(){var t,a=(0,_.default)(e);if(O()){var l=(0,_.default)(this).constructor;t=Reflect.construct(a,arguments,l)}else t=a.apply(this,arguments);return(0,y.default)(this,t)}}function O(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var q=D.default.Option,B=(M.default.Search,a("wd/R"),x=E.default.create(),v=(0,T.connect)(function(e){var t=e.mess.messInfo,a=e.global.GlobalCountryMap;return{messInfo:t,GlobalCountryMap:a}}),x(w=v((b=function(e){(0,h.default)(a,e);var t=G(a);function a(e){var l;return(0,p.default)(this,a),l=t.call(this,e),l.state={filters:{},disabled:!1,duration:0},l.uploadMultiMediaHandle=function(){},l.handleSubmit=function(){var e=l.props.form.getFieldsValue,t=l.state.filters,a=l.props.computedMatch.params,n=a.copy,s=a.id,r=e();if(!(0,S.default)(r,"title"))return c.default.error((0,H.formatMessage)({id:"form.operation.ptitle"}));if(!(0,S.default)(r,"content"))return c.default.error((0,H.formatMessage)({id:"form.operation.pcontent"}));if(!(0,S.default)(r,"send_type")&&0!=(0,S.default)(r,"send_type"))return c.default.error((0,H.formatMessage)({id:"form.operation.psendmss"}));l.setState({disabled:!0});var u=(0,m.default)({},t,r);u=(0,I.momentToString)(u);var d=u.send_timing?{send_timing:u.send_timing.substring(0,u.send_timing.length-3)}:{};u=(0,m.default)({},u,d),(0,S.default)(u,"message_type")||(u=(0,m.default)({},u,{message_type:0})),!s&&"0"!==s&&0!==s||n?(delete u.status,(0,C.messAdd)((0,m.default)({},u,{id:""})).then(function(e){e.code||l.onCancel(),l.setState({disabled:!1})})):(0,C.messModify)(u).then(function(e){l.setState({disabled:!1}),e.code||l.onCancel()})},l.onCancel=function(){N.default.push("/operation/assistant/messagepush")},l.getDetail=function(){var e=l.props.dispatch,t=l.props.computedMatch.params.id;(t||"0"===t||0===t)&&e({type:"mess/messInfo",payload:{id:t}}).then(function(e){e.code||l.setState({duration:e.data.duration})})},l.componentDidMount=function(){var e=l.props.dispatch;e({type:"global/getGlobalCountryMap"}),l.getDetail()},l.onChangeUseridsTag=function(e){var t=e.target.value;l.setState(function(e){var a=e.filters;return{filters:(0,m.default)({},a,{send_user_ids_tag:t})}})},l.onChangeSendType=function(e){var t=e.target.value;l.setState(function(e){var a=e.filters;return{filters:(0,m.default)({},a,{send_type:t})}})},l.getMediaMatter=function(e,t){t&&(e={url:"",thumb_base64:"",duration:0,message_type:0,size:"",weight_high:"",path:""}),l.setState(function(t){var a=t.filters;return{filters:(0,m.default)({},a,e),duration:e.duration}})},l.onChangeDuration=function(e){var t=e.target.value;l.setState(function(e){var a=e.filters;return{duration:t,filters:(0,m.default)({},a,{duration:t})}})},l.render=function(){var e=l.props.computedMatch.params,t=(e.copy,e.id),a=l.props,n=a.form.getFieldDecorator,m=a.GlobalCountryMap,c=l.state,p=c.filters,g=c.disabled,h=c.filters.message_type,y=[{icon:"desktop",name:(0,H.formatMessage)({id:"menu.operation"})},{link:"/operation/messagepush",name:(0,H.formatMessage)({id:"menu.operation.xiaomishupush"})},{name:(0,H.formatMessage)({id:(0,A.default)(t)?"operation.messagepush.add":"form.operation.edit"})}],_={width:"100%",textAlign:"left",paddingLeft:"10px"},x={display:"block",height:"30px",lineHeight:"30px"};return j.default.createElement("div",{className:"message_push_up"},j.default.createElement(E.default,{layout:"vertical",hideRequiredMark:!0},j.default.createElement(d.default,{title:j.default.createElement(Y.default,{src:y,className:R.default.breadcrumb_Box}),className:R.default.card_wrap},j.default.createElement(d.default.Grid,{style:_},j.default.createElement(f.default,{type:"flex",justify:"start",gutter:16},j.default.createElement(o.default,{style:{width:"140px",textAlign:"right"}},j.default.createElement("span",{className:"".concat(R.default.detail_title," ").concat(R.default.required)},(0,H.formatMessage)({id:"operation.messagepush.title"}))),j.default.createElement(o.default,{span:18},j.default.createElement(E.default.Item,null,n("title",{initialValue:p.title||""})(j.default.createElement(M.default,{placeholder:(0,H.formatMessage)({id:"operation.messagepush.title"})}))))),j.default.createElement(f.default,{type:"flex",justify:"start",gutter:16},j.default.createElement(o.default,{style:{width:"140px",textAlign:"right"}},j.default.createElement("span",{className:"".concat(R.default.detail_title," ").concat(R.default.required)},(0,H.formatMessage)({id:"operation.messagepush.pushContent"}))),j.default.createElement(o.default,{span:18},j.default.createElement(E.default.Item,null,n("content",{initialValue:p.content||""})(j.default.createElement(M.default.TextArea,{rows:4,placeholder:(0,H.formatMessage)({id:"operation.messagepush.pushContent"})}))))),j.default.createElement(f.default,{type:"flex",justify:"start",gutter:16},j.default.createElement(o.default,{style:{width:"140px",textAlign:"right"}},j.default.createElement("span",{className:R.default.detail_title},(0,H.formatMessage)({id:"operation.messagepush.upload"}))),j.default.createElement(o.default,{span:18},j.default.createElement(E.default.Item,null,j.default.createElement(k.default,(0,i.default)({},p,{callback:l.getMediaMatter}))))),(2==h||3==h)&&j.default.createElement(f.default,{type:"flex",justify:"start",gutter:16},j.default.createElement(o.default,{style:{width:"140px",textAlign:"right"}},j.default.createElement("span",{className:R.default.detail_title},(0,H.formatMessage)({id:"operation.messagepush.duration"}))),j.default.createElement(o.default,{span:4},j.default.createElement(E.default.Item,null,j.default.createElement(M.default,{value:l.state.duration,addonAfter:"Second",placeholder:(0,H.formatMessage)({id:"operation.messagepush.duration"}),onChange:l.onChangeDuration})))))),j.default.createElement(d.default,{className:R.default.card_wrap},j.default.createElement(d.default.Grid,{style:_},j.default.createElement(f.default,{type:"flex",justify:"start",gutter:16},j.default.createElement(o.default,{style:{width:"140px",textAlign:"right"}},j.default.createElement("span",{className:"".concat(R.default.detail_title)},(0,H.formatMessage)({id:"operation.messagepush.client"}))),j.default.createElement(o.default,{span:18},j.default.createElement(E.default.Item,null,n("send_platform",{initialValue:p.send_platform||"0"})(j.default.createElement(u.default.Group,null,Object.keys(V.send_platform_enum).map(function(e,t){return j.default.createElement(u.default,{key:t,value:e},V.send_platform_enum[e])})))))),j.default.createElement(f.default,{type:"flex",justify:"start",gutter:16},j.default.createElement(o.default,{style:{width:"140px",textAlign:"right"}},j.default.createElement("span",{className:R.default.detail_title},"\u9009\u62e9\u56fd\u5bb6")),j.default.createElement(o.default,{span:18},j.default.createElement(E.default.Item,null,n("send_nation",p.send_nation&&0!=p.send_nation?{initialValue:+p.send_nation}:{})(j.default.createElement(D.default,{style:{width:"400px"},placeholder:"\u8bf7\u9009\u62e9\u56fd\u5bb6"},m.map(function(e,t){return j.default.createElement(q,{key:t,value:e.id},e.name)})))))),j.default.createElement(f.default,{type:"flex",justify:"start",gutter:16},j.default.createElement(o.default,{style:{width:"140px",textAlign:"right"}},j.default.createElement("span",{className:R.default.detail_title},(0,H.formatMessage)({id:"operation.messagepush.pushClientTag"}))),j.default.createElement(o.default,{span:18},j.default.createElement(E.default.Item,null,n("send_user_tag",{initialValue:p.send_user_tag||"0"})(j.default.createElement(u.default.Group,null,Object.keys(V.send_user_tag_enum).map(function(e,t){return j.default.createElement(u.default,{key:t,value:e},V.send_user_tag_enum[e])})))))),j.default.createElement(f.default,{type:"flex",justify:"start",gutter:16},j.default.createElement(o.default,{style:{width:"140px",textAlign:"right"}},j.default.createElement("span",{className:R.default.detail_title},(0,H.formatMessage)({id:"operation.messagepush.pushClientTime"}))),j.default.createElement(o.default,{style:{width:"300px"}},!!p.send_user_reg_start&&j.default.createElement(E.default.Item,null,n("send_user_reg_start",{initialValue:p.send_user_reg_start})(j.default.createElement(r.default,{style:{width:"100%"},format:"YYYY-MM-DD HH:mm:ss",showTime:!0,placeholder:(0,H.formatMessage)({id:"operation.messagepush.startRegisterTime"})}))),!p.send_user_reg_start&&j.default.createElement(E.default.Item,null,n("send_user_reg_start")(j.default.createElement(r.default,{style:{width:"100%"},format:"YYYY-MM-DD HH:mm:ss",showTime:!0,placeholder:(0,H.formatMessage)({id:"operation.messagepush.startRegisterTime"})})))),j.default.createElement(o.default,{style:{width:"300px"}},!!p.send_user_reg_end&&j.default.createElement(E.default.Item,null,n("send_user_reg_end",{initialValue:p.send_user_reg_end})(j.default.createElement(r.default,{style:{width:"100%"},showTime:!0,format:"YYYY-MM-DD HH:mm:ss",placeholder:(0,H.formatMessage)({id:"operation.messagepush.endRegisterTime"})}))),!p.send_user_reg_end&&j.default.createElement(E.default.Item,null,n("send_user_reg_end")(j.default.createElement(r.default,{style:{width:"100%"},showTime:!0,format:"YYYY-MM-DD HH:mm:ss",placeholder:(0,H.formatMessage)({id:"operation.messagepush.endRegisterTime"})}))))),j.default.createElement(f.default,{type:"flex",justify:"start",gutter:16},j.default.createElement(o.default,{style:{width:"140px",textAlign:"right"}},j.default.createElement("span",{className:R.default.detail_title},(0,H.formatMessage)({id:"operation.messagepush.pushClientRange"}))),j.default.createElement(o.default,{style:{width:"230px"}},n("send_user_ids",{initialValue:p.send_user_ids||""})(j.default.createElement(M.default,{placeholder:"UID1,UID2,UID3...",style:{width:"100%"}}))),j.default.createElement(o.default,{style:{width:"230px"}},j.default.createElement("span",{style:{color:"#f5222d",lineHeight:"32px"}},(0,H.formatMessage)({id:"form.operation.tipmess"}))))),j.default.createElement(d.default.Grid,{style:_},j.default.createElement(f.default,{type:"flex",justify:"start",gutter:16},j.default.createElement(o.default,{style:{width:"140px",textAlign:"right"}},j.default.createElement("span",{className:"".concat(R.default.detail_title," ").concat(R.default.required)},(0,H.formatMessage)({id:"operation.messagepush.sendMethod"}))),j.default.createElement(o.default,{span:18},j.default.createElement(E.default.Item,{style:{paddingBottom:"0px",marginBottom:"6px"}},n("send_type",{initialValue:p.send_type||""})(j.default.createElement(u.default.Group,{onChange:l.onChangeSendType},Object.keys(V.send_type_enum).map(function(e,t){return t===Object.keys(V.send_type_enum).length-1?j.default.createElement(u.default,{key:t,value:e},V.send_type_enum[e]):j.default.createElement(u.default,{key:t,value:e,style:x},V.send_type_enum[e])})))),!p.send_timing&&j.default.createElement(E.default.Item,null,n("send_timing")(j.default.createElement(r.default,{style:{width:"220px",marginTop:"2px"},showTime:!0,format:"YYYY-MM-DD HH:mm",placeholder:(0,H.formatMessage)({id:"operation.messagepush.psendtime"}),disabled:!(3==p.send_type)}))),!!p.send_timing&&j.default.createElement(E.default.Item,null,n("send_timing",{initialValue:p.send_timing})(j.default.createElement(r.default,{style:{width:"220px",marginTop:"2px"},showTime:!0,format:"YYYY-MM-DD HH:mm",placeholder:(0,H.formatMessage)({id:"operation.messagepush.psendtime"}),disabled:!(3==p.send_type)}))))),j.default.createElement(f.default,{type:"flex",justify:"start",gutter:16},j.default.createElement(o.default,{style:{width:"30%"}}),j.default.createElement(s.default,{type:"primary",disabled:g,onClick:l.handleSubmit},(0,H.formatMessage)({id:"operation.messagepush.submit"})),j.default.createElement(s.default,{style:{marginLeft:"30px"},onClick:l.onCancel},(0,H.formatMessage)({id:"form.operation.cancel"})))))))},l}return(0,g.default)(a,null,[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.messInfo;return a!=t.filters&&0==Object.keys(t.filters).length?{filters:a}:null}}]),a}(j.PureComponent),w=b))||w)||w);t.default=B}}]);