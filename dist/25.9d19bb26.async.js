(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[25],{"DD//":function(e,t,a){e.exports={icon:"antd-pro-pages-operation-gift-list-icon",handle:"antd-pro-pages-operation-gift-list-handle","operations-wraper":"antd-pro-pages-operation-gift-list-operations-wraper",edit:"antd-pro-pages-operation-gift-list-edit",danger:"antd-pro-pages-operation-gift-list-danger",delete:"antd-pro-pages-operation-gift-list-delete antd-pro-pages-operation-gift-list-danger",mrm:"antd-pro-pages-operation-gift-list-mrm",effect:"antd-pro-pages-operation-gift-list-effect",canvas:"antd-pro-pages-operation-gift-list-canvas",play:"antd-pro-pages-operation-gift-list-play",hide:"antd-pro-pages-operation-gift-list-hide"}},GmJg:function(e,t,a){"use strict";var n=a("tAuX"),i=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var r=i(a("W9HT"));a("2qtc");var o=i(a("kLXV"));a("P2fV");var s=i(a("NJEC"));a("DZo9");var l=i(a("8z0m")),c=i(a("gWZ8"));a("7Kak");var f=i(a("9yH6"));a("BoS7");var d=i(a("Sdc0"));a("+L6B");var u=i(a("2/Rp"));a("Pwec");var p=i(a("CtXQ"));a("y8nQ");var m=i(a("Vl3Y")),g=i(a("d6i3")),h=i(a("2Taf")),y=i(a("vZ4D")),v=i(a("rlhR")),b=i(a("MhPg")),_=i(a("l4Ni")),E=i(a("ujKo"));a("OaEy");var M=i(a("2fM7"));a("5NDa");var k=i(a("5rEg")),w=a("MuoO"),x=n(a("q1tI")),S=a("LLXN"),O=i(a("mwIZ")),N=i(a("Wwog")),C=i(a("Y+p1")),F=i(a("uztb"));function P(e){return function(){var t,a=(0,E.default)(e);if(R()){var n=(0,E.default)(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return(0,_.default)(this,t)}}function R(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var V=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o},D=function(e,t,a,n){function i(e){return e instanceof a?e:new a(function(t){t(e)})}return new(a||(a=Promise))(function(a,r){function o(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n["throw"](e))}catch(e){r(e)}}function l(e){e.done?a(e.value):i(e.value).then(o,s)}l((n=n.apply(e,t||[])).next())})},j=a("xDdU"),I=k.default.Group,L=M.default.Option,T=0,A=function(e){(0,b.default)(a,e);var t=P(a);function a(){var e;return(0,h.default)(this,a),e=t.apply(this,arguments),e.state={visible:!1,giftKeys:[],formItemLayout:{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},formItemLayoutWithOutLabel:{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},fields:[{name:"cate_id",placeholder:(0,S.formatMessage)({id:"app.gift.tools.cate_placeholder"}),options:{rules:[{required:!0,message:(0,S.formatMessage)({id:"app.gift.tools.cate_required"})}]},type:"select",label:(0,S.formatMessage)({id:"app.gift.tools.cate"})},{name:"name",placeholder:(0,S.formatMessage)({id:"app.scene.tools.name_placeholder"}),options:{rules:[{required:!0,message:(0,S.formatMessage)({id:"app.scene.tools.name_required"})}]},label:(0,S.formatMessage)({id:"app.scene.tools.name"})},{name:"stat_key",placeholder:"\u8bf7\u8f93\u5165\u9053\u5177key\u503c",options:{rules:[{required:!0,message:"stat_key"}]},label:"\u9053\u5177key\u503c"},{name:"sub_gifts",label:(0,S.formatMessage)({id:"app.gift.sub_gifts"}),properties:[{placeholder:(0,S.formatMessage)({id:"app.gift.sub_gifts.placeholder"}),type:"number"},{placeholder:(0,S.formatMessage)({id:"app.gift.sub_gifts.number.placeholder"}),type:"number"}],input_type:"group"},{name:"price",placeholder:(0,S.formatMessage)({id:"app.gift.price"}),options:{rules:[]},input_type:"number",label:(0,S.formatMessage)({id:"app.gift.price"})},{name:"sort",placeholder:(0,S.formatMessage)({id:"app.scene.tools.sort_placeholder"}),options:{rules:[]},input_type:"number",label:(0,S.formatMessage)({id:"app.scene.tools.sort"})},{name:"is_vip",options:{valuePropName:"checked",initialValue:!1,rules:[]},properties:{checkedChildren:(0,S.formatMessage)({id:"app.gift.is_vip.yes"}),unCheckedChildren:(0,S.formatMessage)({id:"app.gift.is_vip.no"})},type:"switch",label:(0,S.formatMessage)({id:"app.gift.is_vip"})},{name:"is_combo",options:{valuePropName:"checked",initialValue:!1,rules:[]},properties:{checkedChildren:(0,S.formatMessage)({id:"app.gift.yes"}),unCheckedChildren:(0,S.formatMessage)({id:"app.gift.no"})},type:"switch",label:(0,S.formatMessage)({id:"app.gift.is_combo"})},{name:"icon",placeholder:(0,S.formatMessage)({id:"app.gift.icon.placeholder"}),options:{rules:[{required:!0,message:(0,S.formatMessage)({id:"app.face.tools.thumb_required"})}]},type:"upload",label:(0,S.formatMessage)({id:"app.gift.icon"}),properties:{listType:"picture-card"}},{name:"effect",placeholder:(0,S.formatMessage)({id:"app.gift.effect.placeholder"}),options:{rules:[]},type:"upload",label:(0,S.formatMessage)({id:"app.gift.effect"}),properties:{}},{name:"mark",placeholder:(0,S.formatMessage)({id:"app.gift.icon.placeholder"}),options:{},type:"upload",label:(0,S.formatMessage)({id:"app.gift.tools.mark"}),properties:{listType:"picture-card"}},{name:"game_effect",placeholder:(0,S.formatMessage)({id:"app.gift.effect.placeholder"}),options:{rules:[]},type:"upload",label:(0,S.formatMessage)({id:"app.gift.animation_effect"}),properties:{}},{name:"status",options:{valuePropName:"checked",initialValue:!1,rules:[]},type:"switch",label:(0,S.formatMessage)({id:"app.scene.category.switch"})}]},e.cancelSwitch=function(){e.props.form.setFieldsValue({status:!0})},e.confirmSwitch=function(){e.props.form.setFieldsValue({status:!1})},e.handleCancel=function(){e.setState({visible:!1}),e.props.form.resetFields(),T=0,e.props.close()},e.getImageBound=function(e){return new Promise(function(t,a){var n=new Image;n.onload=function(){t({width:n.width,height:n.height})},n.onerror=function(){a()},n.src=e})},e.handleOk=function(){return D((0,v.default)(e),void 0,void 0,g.default.mark(function e(){var t,a,n,i,r,o,s,l,c,f,d=this;return g.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this,t=this.props,a=t.form,n=a.validateFields,i=a.getFieldsValue,r=a.getFieldValue,a.resetFields,o=t.dispatch,s=t.close,l=t.id,c=t.list,f=t.resetEffect,c.find(function(e){return e.id===l}),n(function(e){return D(d,void 0,void 0,g.default.mark(function t(){var a,n,c,d,u=this;return g.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!e){t.next=2;break}return t.abrupt("return");case 2:return o({type:"gift/updateState",payload:{loading:!0}}),a=i(),n=new FormData,a.status=!0===a.status?1:0,console.info("handleOk_values",a),c=Object.keys(a),t.next=10,Promise.all(c.map(function(e){return D(u,void 0,void 0,g.default.mark(function t(){var i,o,s,c,d;return g.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(i=a[e],void 0!==i){t.next=3;break}return t.abrupt("return");case 3:if("is_vip"!==e&&"is_combo"!==e){t.next=5;break}return t.abrupt("return",n.append(e,i?"1":"0"));case 5:if(-1===e.indexOf("sub_gifts")){t.next=14;break}if(o=r("sub_gifts"),s=r("sub_gifts_amount"),c={},o.map(function(e,t){c[e]=+s[t]}),"sub_gifts"!==e){t.next=13;break}return console.info("gifts__",c),t.abrupt("return",n.append(e,JSON.stringify(c)));case 13:return t.abrupt("return");case 14:if("object"!==typeof i||!i){t.next=23;break}if(!(Array.isArray(i)&&i[0]&&i[0].url)){t.next=17;break}return t.abrupt("return",n.append(e,i[0].path));case 17:if(l&&"effect"===e&&"function"===typeof f&&f(l),d=(0,O.default)(i[0],"originFileObj"),d){t.next=21;break}return t.abrupt("return");case 21:return console.info("handleOK_value",{key:e,value:i,name:(0,O.default)(i[0],"name")}),t.abrupt("return",n.append(e,d,(0,O.default)(i[0],"name")));case 23:n.append(e,i);case 24:case"end":return t.stop()}},t)}))}));case 10:if(l&&n.append("id",l),!l){t.next=17;break}return t.next=14,o({payload:{params:n,id:l},type:"gift/patch"});case 14:t.t0=t.sent,t.next=20;break;case 17:return t.next=19,o({payload:n,type:"gift/create"});case 19:t.t0=t.sent;case 20:d=t.t0,o({type:"gift/updateState",payload:{loading:!1}}),d&&(T=0,s());case 23:case"end":return t.stop()}},t)}))});case 4:case"end":return e.stop()}},e,this)}))},e.normFile=function(e){return console.info("normFile__",e),Array.isArray(e)?e:e&&Array.isArray(e.fileList)?e.fileList.slice(-1):e&&e.fileList},e.removeGift=function(t){var a=e.state.giftKeys;console.info("removeGift__",a,t,a.filter(function(e){return e!==t})),e.setState({giftKeys:a.filter(function(e){return e!==t})})},e.addGift=function(){var t=e.state.giftKeys,a=t.concat(T++);e.setState({giftKeys:a})},e.renderGifts=function(){var t=e.props,a=t.form,n=(a.getFieldValue,a.getFieldDecorator),i=t.roomGifts,r=void 0===i?[]:i,o=e.state,s=o.formItemLayout,l=o.formItemLayoutWithOutLabel,c=(0,v.default)(e),f=c.addGift,d=c.removeGift;return function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=(arguments.length>3&&arguments[3],e.name),o=e.properties,c=e.id,g=a.map(function(e,f){var u;return u=Object.keys(t)[e],console.info("renderGifts_key","".concat(c,"_").concat(i,"_").concat(e)),x.default.createElement(m.default.Item,Object.assign({},0===f?s:l,{label:0===f?(0,S.formatMessage)({id:"app.gift.sub_gifts"}):"",required:!1,key:"".concat(c,"_").concat(i,"_").concat(e),className:F.default["group-wraper"]}),x.default.createElement(I,{compact:!0},x.default.createElement(m.default.Item,{style:{width:"40%"}},n("".concat(i,"[").concat(e,"]"),{initialValue:u})(x.default.createElement(M.default,Object.assign({},o[0],{style:{width:"100%"}}),r.map(function(e){return x.default.createElement(L,{key:e.id,value:e.id},e.name)})))),x.default.createElement(m.default.Item,{style:{width:"40%"}},n("sub_gifts_amount[".concat(e,"]"),{initialValue:t[u]||1})(x.default.createElement(k.default,Object.assign({className:F.default["gift-unit"]},o[1],{style:{textAlign:"right"},min:1,addonAfter:x.default.createElement("span",null,(0,S.formatMessage)({id:"app.gift.sub_gifts.unit"}))}))))),a.length>0?x.default.createElement(p.default,{className:F.default["delete-button"],type:"minus-circle-o",onClick:function(){return d(e)}}):null)});return x.default.createElement(x.default.Fragment,null,g,x.default.createElement(m.default.Item,Object.assign({key:"".concat(i,"_add")},l),x.default.createElement(u.default,{type:"dashed",onClick:f,style:{width:"60%"}},x.default.createElement(p.default,{type:"plus"})," ",(0,S.formatMessage)({id:"app.gift.sub_gifts.add"}))))}},e.renderFieldName=function(t){var a=(0,v.default)(e);return(0,N.default)(function(t,n,i,r,o){console.info("renderFieldName__",t.name);var g=e.props,h=g.form,y=h.getFieldDecorator,v=(h.setFieldsValue,h.getFieldValue,g.cates),b=g.id,_=(g.list,e.state),E=(_.fields,_.formItemLayout),w=t.name,O=t.options,N=t.input_type,C=t.placeholder,F=t.label,P=t.type,R=(t.initialValue,t.properties),V=void 0===R?{}:R;if(n&&w in n)if("switch"===t.type)t.options.initialValue=!!+n[w];else if("upload"===t.type){var D=n[w];n["remote_".concat(w)]&&(D=n["remote_".concat(w)]),D&&(t.options.initialValue=[{url:D,path:n["".concat(w,"_path")],name:n.name+w,uid:j()}])}else t.options.initialValue=n[w];var I=x.default.createElement(k.default,{key:w,type:N,placeholder:C}),L=!1,T=e.cancelSwitch,A="",z=t.optionList;if("string"===typeof z&&(z=e.props[z]),"textarea"===P){var K=k.default.TextArea;I=x.default.createElement(K,Object.assign({key:w},V))}if("switch"===P&&(b&&!0===O.initialValue&&"status"===w&&(L=!0,A=n.tool_count>0?(0,S.formatMessage)({id:"app.scene.category.has_tool_offline_hint"}):(0,S.formatMessage)({id:"app.scene.category.offline_hint"})),I=x.default.createElement(d.default,Object.assign({},V,{key:w}))),"radio"===P){var G=f.default.Group,q=(0,c.default)(z).map(function(e){return x.default.createElement(f.default,{key:e[0],value:e[0]},e[1])});I=x.default.createElement(G,{key:w},q)}if("select"===P){var J,X=M.default.Option,B=!1;J="cate_id"===w?v.filter(function(e){return 1==e.status||n.cate_id==e.id}).map(function(e){var t="";return 0==e.status&&(t=" (".concat((0,S.formatMessage)({id:"app.scene.category.status_offline"}),")")),x.default.createElement(X,{key:e.id,value:e.id},e.name,t)}):(0,c.default)(z).map(function(e){return x.default.createElement(X,{key:e[0],value:e[0]},e[1])}),I=x.default.createElement(M.default,{key:w,disabled:B,placeholder:C},J)}return"upload"===P&&(O.valuePropName="fileList",O.getValueFromEvent=e.normFile,V.customRequest=function(e){e.file;var t=e.onSuccess;setTimeout(function(){t("ok")},0)},I=x.default.createElement(l.default,Object.assign({key:w},V),x.default.createElement(u.default,null,x.default.createElement(p.default,{type:"cloud-upload"})," ",C))),x.default.createElement(m.default.Item,Object.assign({key:w},E,{label:F}),L?x.default.createElement(s.default,{title:A,okText:(0,S.formatMessage)({id:"app.scene.category.offline_confirm"}),cancelText:(0,S.formatMessage)({id:"app.scene.category.offline_cancel"}),okType:"danger",onCancel:T,onConfirm:a.confirmSwitch},y(w,O)(I)):y(w,O)(I))},C.default)},e.componentDidMount=function(){var t=e.props,a=t.id,n=t.list,i=(t.form.getFieldDecorator,n.find(function(e){return e.id===a}));if(i&&i.id){var r="sub_gifts",o=i[r];if(console.info("componentDidMount_",{subGifts:o,id:a}),o){o=JSON.parse(i[r]);var s=[];Object.keys(o).map(function(e,t){s[t]=T++}),e.setState({loaded:!0,giftKeys:s})}}},e}return(0,y.default)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.visible,n=(t.formItemLayout,t.fields),i=this.props,s=i.visible,l=(i.close,i.form),c=(l.getFieldDecorator,l.getFieldsValue,l.getFieldValue),f=(l.setFieldsValue,l.resetFields,l.getFieldError),d=i.caption,u=i.id,p=i.list,g=(i.cates,i.clients),h=(void 0===g&&new Map,i.loading),y={};u&&p&&(y=p&&p.find(function(e){return e.id===u})),console.info("fields__",n);var v=n.map(function(t){var a=t.name,n="renderField_".concat(a),i=e[n];if("sub_gifts"===a){var r=y[a]?JSON.parse(y[a]):{};i||(i=e[n]=e.renderGifts());var o=e.state.giftKeys;return console.info("render_keys__",o),i(t,r,o)}i||(i=e[n]=e.renderFieldName(a));var s,l=f(a),d=c(a);return Array.isArray(c(a))&&(d=(0,O.default)(c(a)[0],"status")||c(a).length),i(t,y,d,l,s)}),b=h?"":" ".concat(F.default["hide"]);return x.default.createElement(x.default.Fragment,null,x.default.createElement(o.default,{title:d||(0,S.formatMessage)({id:"app.scene.tools.add"}),visible:a||s,onOk:this.handleOk,onCancel:this.handleCancel},x.default.createElement(m.default,{autoComplete:"off"},v)),x.default.createElement("div",{className:"".concat(F.default.loading).concat(b)},x.default.createElement(r.default,{size:"large"})))}}]),a}(x.PureComponent);A=V([(0,w.connect)(function(e){var t=e.gift,a=t.loading,n=t.list,i=t.clients,r=t.roomGifts,o=e.giftCategories.list;return{loading:a,cates:o,list:n,clients:i,roomGifts:r}}),m.default.create()],A);var z=A;t.default=z},"KR/a":function(e,t,a){e.exports={operation:"antd-pro-pages-operation-gift-components-operation-bar.css-operation","operation-btn":"antd-pro-pages-operation-gift-components-operation-bar.css-operation-btn","search-wraper":"antd-pro-pages-operation-gift-components-operation-bar.css-search-wraper","search-btn":"antd-pro-pages-operation-gift-components-operation-bar.css-search-btn",all:"antd-pro-pages-operation-gift-components-operation-bar.css-all",offline:"antd-pro-pages-operation-gift-components-operation-bar.css-offline"}},a1Pj:function(e,t,a){"use strict";var n=a("tAuX"),i=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var r=i(a("wCAj"));a("+L6B");var o=i(a("2/Rp"));a("/zsF");var s=i(a("PArb"));a("P2fV");var l=i(a("NJEC"));a("Pwec");var c=i(a("CtXQ"));a("+BJd");var f=i(a("mr32")),d=i(a("d6i3")),u=i(a("eHn4"));a("2qtc");var p=i(a("kLXV")),m=i(a("2Taf")),g=i(a("vZ4D")),h=i(a("rlhR")),y=i(a("MhPg")),v=i(a("l4Ni")),b=i(a("ujKo"));a("5NDa");var _=i(a("5rEg")),E=a("MuoO"),M=n(a("q1tI")),k=a("LLXN"),w=i(a("DD//")),x=i(a("wUuB")),S=i(a("71zH")),O=i(a("GmJg")),N=a("j156");function C(e){return function(){var t,a=(0,b.default)(e);if(F()){var n=(0,b.default)(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return(0,v.default)(this,t)}}function F(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var P=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o},R=function(e,t,a,n){function i(e){return e instanceof a?e:new a(function(t){t(e)})}return new(a||(a=Promise))(function(a,r){function o(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n["throw"](e))}catch(e){r(e)}}function l(e){e.done?a(e.value):i(e.value).then(o,s)}l((n=n.apply(e,t||[])).next())})},V=(_.default.Search,function(e){(0,y.default)(a,e);var t=C(a);function a(e){var n;return(0,m.default)(this,a),n=t.call(this,e),n.fetchPage=function(e,t){var a=n.state.search,i=void 0===a?{}:a;n.props.dispatch({type:"gift/fetch",payload:Object.assign({page:e,page_size:t},i)})},n.search=function(e){n.setState({search:e});var t=n.props.pageSize;n.props.dispatch({type:"gift/updateState",payload:{filter:e}}),n.props.dispatch({payload:Object.assign(Object.assign({},e),{page:1,pageSize:t}),type:"gift/fetch"}),n.resetEffect()},n.delete=function(e){var t=e.id,a=e.status;if(1==a)return p.default.warn({title:(0,k.formatMessage)({id:"app.scene.tools.delete_hint_title"}),content:(0,k.formatMessage)({id:"app.scene.tools.delete_hint_content"}),okText:(0,k.formatMessage)({id:"app.scene.tools.delete_hint_btn"})});n.props.dispatch({payload:{id:t},type:"gift/delete"})},n.showEdit=function(e,t){var a=t.id;e.preventDefault(),n.setState({editId:a})},n.hideEdit=function(){n.setState({editId:null})},n.showAdd=function(){n.setState({adding:!0})},n.hideAdd=function(){n.setState({adding:!1})},n.putOnline=function(e){n.props.dispatch({type:"gift/patchStatus",payload:{id:e,status:1}})},n.putOffline=function(e){n.props.dispatch({type:"gift/patchStatus",payload:{id:e,status:0}})},n.batchOnline=function(){var e=n.state.selectedRowKeys;p.default.confirm({title:(0,k.formatMessage)({id:"app.scene.tools.batch_online_hint"},{selected:e.length}),onOk:function(){n.props.dispatch({type:"gift/batchModify",payload:{id:e.join(","),status:1}}).then(n.onSelectChange.bind((0,h.default)(n),[]))}})},n.batchOffline=function(){var e=n.state.selectedRowKeys;p.default.confirm({title:(0,k.formatMessage)({id:"app.scene.tools.batch_offline_hint"},{selected:e.length}),onOk:function(){n.props.dispatch({type:"gift/batchModify",payload:{id:e.join(","),status:0}}).then(n.onSelectChange.bind((0,h.default)(n),[]))}})},n.onShowSizeChange=function(e,t){n.props.dispatch({type:"gift/changePageSize",payload:{page:e,pageSize:t}}),n.fetchPage(e,t)},n.onSelectChange=function(e){var t=!(e.length>0);n.setState({batchDisable:t}),n.setState({selectedRowKeys:e})},n.playSVGA=function(e,t){return R((0,h.default)(n),void 0,void 0,d.default.mark(function a(){var n,i,r,o,s,l;return d.default.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return i=new N.Downloader,r=new N.Parser,o=new N.Player("#".concat(e)),a.next=5,i.get(t);case 5:return s=a.sent,a.next=8,r.do(s);case 8:return l=a.sent,o.set({loop:1,fillMode:"forwards"}),a.next=12,o.mount(l);case 12:this.setState((n={},(0,u.default)(n,e,"loaded"),(0,u.default)(n,"currentEffect",e),n),function(){o.start()});case 13:case"end":return a.stop()}},a,this)}))},n.resetEffect=function(e){e||n.setState({currentEffect:null}),"effect".concat(e)===n.state.currentEffect&&n.setState({currentEffect:null})},n.state={adding:!1,editId:null,selectedRowKeys:[],batchDisable:!0,batchLoading:!1,currentEffect:0},n}return(0,g.default)(a,[{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"gift/updateState",payload:{page:1,filter:{}}})}},{key:"render",value:function(){var e=this,t=this,a=this.props,n=a.list,i=a.cates,d=a.statuses,u=a.total,p=a.pageSize,m=a.page,g=a.clients,h=[{icon:"desktop",title:(0,k.formatMessage)({id:"menu.operation"})},{icon:"gift",title:(0,k.formatMessage)({id:"menu.operation.gift"})},{title:(0,k.formatMessage)({id:"menu.operation.gift.list"})}],y=[{title:(0,k.formatMessage)({id:"app.scene.tools.id"}),dataIndex:"id",align:"center"},{title:"\u9053\u5177\u540d\u79f0",dataIndex:"name",align:"center"},{title:"\u9053\u5177key\u503c",dataIndex:"stat_key",align:"center"},{title:(0,k.formatMessage)({id:"app.gift.tools.cate"}),dataIndex:"cate_id",render:function(e,t){var a=i.find(function(t){return t.id==e})||{};return a.name}},{title:(0,k.formatMessage)({id:"app.scene.tools.icon"}),dataIndex:"icon",render:function(e,t){return M.default.createElement("img",{className:w.default.icon,src:e,alt:t.name})}},{title:(0,k.formatMessage)({id:"app.gift.effect"}),dataIndex:"effect",render:function(t,a){if(t){var n="effect".concat(a.id),i=e.state.currentEffect,r=i===n,o="".concat(r?w.default.canvas:w.default.hide),s="".concat(r?w.default.hide:w.default.icon);"".concat(r?w.default.hide:w.default.play);return M.default.createElement("div",{className:w.default.effect,onClick:function(){e.playSVGA(n,t)}},M.default.createElement("canvas",{className:o,id:"".concat(n),"data-src":t}),M.default.createElement("img",{className:s,src:a.icon,alt:""}))}}},{title:(0,k.formatMessage)({id:"app.gift.price"}),dataIndex:"price"},{title:(0,k.formatMessage)({id:"app.scene.tools.status"}),dataIndex:"status",render:function(e,t){var a,n;return 0==e?(a="gray",n=(0,k.formatMessage)({id:"app.scene.tools.offline"})):(a="blue",n=(0,k.formatMessage)({id:"app.scene.tools.online"})),M.default.createElement(f.default,{color:a},n)}},{title:(0,k.formatMessage)({id:"app.gift.is_vip"}),dataIndex:"is_vip",render:function(e){return e>0?(0,k.formatMessage)({id:"app.gift.is_vip.yes"}):(0,k.formatMessage)({id:"app.gift.is_vip.no"})}},{title:(0,k.formatMessage)({id:"app.scene.tools.sort"}),dataIndex:"sort"},{title:(0,k.formatMessage)({id:"app.scene.tools.time"}),dataIndex:"create_at",render:function(e,t){return M.default.createElement(M.Fragment,null,M.default.createElement("div",null,M.default.createElement(c.default,{type:"folder-open",theme:"twoTone"})," ",(0,k.formatMessage)({id:"app.scene.tools.update_time"}),": ",t.update_time),M.default.createElement("div",null,M.default.createElement(c.default,{type:"folder-add",theme:"twoTone"})," ",(0,k.formatMessage)({id:"app.scene.tools.create_time"}),": ",t.create_time))}},{title:(0,k.formatMessage)({id:"app.scene.tools.handle"}),key:"handle",render:function(a,n){var i,r,o,c=(0,k.formatMessage)({id:"app.scene.tools.delete"});if(0==n.status){var f=e.props.cates,d=f.find(function(e){return e.id===n.cate_id}),u=(0,k.formatMessage)({id:"app.scene.category.online_hint"}),p=!1;d&&"0"===d.status&&(p=!0,u=(0,k.formatMessage)({id:"app.face.tools.category_offline_hint"})),!1,i=(0,k.formatMessage)({id:"app.scene.category.online"}),r=M.default.createElement(l.default,{title:u,okText:(0,k.formatMessage)({id:"app.scene.category.offline_confirm"}),cancelText:(0,k.formatMessage)({id:"app.scene.category.offline_cancel"}),okType:"danger",placement:"topRight",onConfirm:function(){p||e.putOnline(n.id)}},M.default.createElement("a",{href:"#",className:w.default.edit},i)),o=M.default.createElement(l.default,{title:(0,k.formatMessage)({id:"app.scene.tools.delete_confirm"}),okText:(0,k.formatMessage)({id:"app.scene.category.offline_confirm"}),cancelText:(0,k.formatMessage)({id:"app.scene.category.offline_cancel"}),okType:"danger",placement:"topRight",onConfirm:t.delete.bind(t,n)},M.default.createElement("a",{href:"#",className:w.default.delete},c))}else{!0,i=(0,k.formatMessage)({id:"app.scene.category.offline"});var m=(0,k.formatMessage)({id:"app.scene.category.offline_hint"});n.tool_count>0&&(m=(0,k.formatMessage)({id:"app.scene.category.has_tool_offline_hint"})),r=M.default.createElement(l.default,{title:m,okText:(0,k.formatMessage)({id:"app.scene.category.offline_confirm"}),cancelText:(0,k.formatMessage)({id:"app.scene.category.offline_cancel"}),okType:"danger",placement:"topRight",onConfirm:t.putOffline.bind(t,n.id)},M.default.createElement("a",{href:"#",className:"".concat(w.default.edit," ").concat(w.default.danger)},i)),o=M.default.createElement("span",{className:w.default.delete,onClick:t.delete.bind(t,n)},c)}return M.default.createElement("div",{className:w.default.handle},M.default.createElement("a",{href:"#",className:w.default.edit,onClick:function(e){t.showEdit(e,n)}},(0,k.formatMessage)({id:"app.scene.tools.handle.edit"})),M.default.createElement(s.default,{type:"vertical"}),r,M.default.createElement(s.default,{type:"vertical"}),o)}}];y=y.map(function(e){return e.align="center",e});var v=this.state,b=v.selectedRowKeys,_=v.batchLoading,E=v.batchDisable;this.onSelectChange;return M.default.createElement(M.Fragment,null,M.default.createElement(S.default,{items:h}),M.default.createElement("div",{className:w.default["operations-wraper"]},M.default.createElement(x.default,{clients:g,cates:i,statuses:d,batchLoading:_,batchDisable:E,search:this.search}),M.default.createElement(o.default,{type:"primary",onClick:this.showAdd},(0,k.formatMessage)({id:"app.scene.tools.add"}))),this.state.adding&&M.default.createElement(O.default,{visible:this.state.adding,cates:i,clients:g,close:this.hideAdd.bind(this)}),M.default.createElement(r.default,{bordered:!0,rowKey:"id",columns:y,dataSource:n,pagination:{position:"both",pageSize:p,showSizeChanger:!0,pageSizeOptions:["20","30","40"],onShowSizeChange:this.onShowSizeChange,total:u,current:m,showTotal:function(e){return(0,k.formatMessage)({id:"app.glob.pagetotal"},{total:e})},size:"small",onChange:this.fetchPage}}),this.state.editId&&M.default.createElement(O.default,{caption:(0,k.formatMessage)({id:"app.scene.tools.edit"}),id:this.state.editId,visible:!!this.state.editId,list:n,cates:i,clients:g,close:this.hideEdit.bind(this),resetEffect:this.resetEffect}))}}]),a}(M.PureComponent));V=P([(0,E.connect)(function(e){var t=e.gift,a=t.list,n=t.statuses,i=t.total,r=t.page,o=t.pageSize,s=t.clients,l=e.giftCategories.list;return{list:a,cates:l,statuses:n,total:i,page:r,pageSize:o,clients:s}})],V);var D=V;t.default=D},uztb:function(e,t,a){e.exports={loading:"antd-pro-pages-operation-gift-edit-loading",hide:"antd-pro-pages-operation-gift-edit-hide","group-wraper":"antd-pro-pages-operation-gift-edit-group-wraper","delete-button":"antd-pro-pages-operation-gift-edit-delete-button","gift-unit":"antd-pro-pages-operation-gift-edit-gift-unit"}},wUuB:function(e,t,a){"use strict";var n=a("tAuX"),i=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("q1tI"));a("14J3");var o=i(a("BMrR"));a("+L6B");var s=i(a("2/Rp"));a("5NDa");var l=i(a("5rEg"));a("OaEy");var c=i(a("2fM7")),f=i(a("2Taf")),d=i(a("vZ4D")),u=i(a("MhPg")),p=i(a("l4Ni")),m=i(a("ujKo"));a("y8nQ");var g,h,y,v=i(a("Vl3Y")),b=a("LLXN"),_=i(a("KR/a"));function E(e){return function(){var t,a=(0,m.default)(e);if(M()){var n=(0,m.default)(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return(0,p.default)(this,t)}}function M(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var k=(g=v.default.create(),g((y=function(e){(0,u.default)(a,e);var t=E(a);function a(){var e;(0,f.default)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),e.handleValues=function(){e.props.form.validateFields(function(t,a){t||e.props.search(a)})},e.reset=function(){e.props.form.resetFields(),e.props.search()},e}return(0,d.default)(a,[{key:"render",value:function(){var e=this.props,t=e.form,a=t.getFieldDecorator,n=(t.getFieldValue,e.positions),i=(void 0===n&&new Map,e.clients),f=(void 0===i&&new Map,e.cates),d=void 0===f?[]:f,u=e.statuses,p=void 0===u?{}:u,m=e.batchLoading,g=e.batchDisable,h=e.batchOnline,y=e.batchOffline,E=c.default.Option,M=Object.keys(p).map(function(e){var t="";return t=0==e?(0,b.formatMessage)({id:"app.face.tools.status.offline"}):(0,b.formatMessage)({id:"app.face.tools.status.online"}),r.default.createElement(E,{key:e,value:e},t)}),k=d.map(function(e){var t=0==e.status?" (".concat((0,b.formatMessage)({id:"app.scene.category.status_offline"}),")"):"",a=e.name;return 0==e.status&&(a=r.default.createElement(r.default.Fragment,null,r.default.createElement("span",{className:_.default.offline},e.name,t))),r.default.createElement(E,{key:e.id,value:e.id},a)});return r.default.createElement(v.default,{autoComplete:"off",className:_.default["search-wraper"]},r.default.createElement(o.default,{className:"operation-bar ".concat(_.default.operations),gutter:10,type:"flex"},r.default.createElement("div",{className:_.default.operation},a("id")(r.default.createElement(l.default,{placeholder:(0,b.formatMessage)({id:"app.scene.tools.id"}),type:"number",onPressEnter:this.handleValues}))),r.default.createElement("div",{className:_.default.operation},a("name")(r.default.createElement(l.default,{placeholder:(0,b.formatMessage)({id:"app.scene.tools.search.name"}),onPressEnter:this.handleValues}))),r.default.createElement("div",{className:_.default.operation},a("stat_key")(r.default.createElement(l.default,{placeholder:"\u9053\u5177key\u503c",onPressEnter:this.handleValues}))),r.default.createElement("div",{className:_.default.operation},a("status")(r.default.createElement(c.default,{placeholder:(0,b.formatMessage)({id:"app.scene.tools.search.status"})},r.default.createElement(E,{value:"",className:_.default.all},(0,b.formatMessage)({id:"app.scene.tools.search.allstatus"})),M))),r.default.createElement("div",{className:_.default.operation},a("cate_id")(r.default.createElement(c.default,{placeholder:(0,b.formatMessage)({id:"app.gift.tools.cate"})},r.default.createElement(E,{value:"",className:_.default.all},(0,b.formatMessage)({id:"app.scene.tools.search.allcates"})),k))),r.default.createElement("div",{className:_.default["operation-btn"]},r.default.createElement(s.default,{type:"primary",icon:"search",onClick:this.handleValues},(0,b.formatMessage)({id:"app.scene.tools.search.btn"}))),r.default.createElement("div",{className:_.default["operation-btn"]},r.default.createElement(s.default,{type:"primary",onClick:this.reset},(0,b.formatMessage)({id:"app.scene.tools.search.reset"}))),h&&r.default.createElement("div",{className:_.default["operation-btn"]},r.default.createElement(s.default,{type:"primary",onClick:h,loading:m,disabled:g},(0,b.formatMessage)({id:"app.scene.tools.batch_online"}))),y&&r.default.createElement("div",{className:_.default["operation-btn"]},r.default.createElement(s.default,{type:"danger",onClick:y,loading:m,disabled:g},(0,b.formatMessage)({id:"app.scene.tools.batch_offline"})))))}}]),a}(r.PureComponent),h=y))||h),w=k;t.default=w}}]);